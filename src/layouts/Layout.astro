---
import "../styles/global.css";
import WhatsappButton from "../components/buttons/WhatsappButton.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";

interface Props {
	title: string;
	description?: string;
	ogTitle?: string;
	ogDescription?: string;
	ogImage?: string;
	canonical?: string;
	noindex?: boolean;
}

const {
	title,
	description = "Agencia de desarrollo web profesional en Santiago, Chile. Expertos en Shopify, WordPress y Next.js. Dise√±o web responsivo, SEO optimizado y soluciones e-commerce escalables.",
	ogTitle = title,
	ogDescription = description,
	ogImage = "https://kreadium.cl/og-tags.png",
	canonical = Astro.url.pathname,
	noindex = false
} = Astro.props;

---

<!doctype html>
<html lang="es">
	<head>
		<meta charset="UTF-8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<!-- Theme color meta tags -->
		<meta name="theme-color" content="#4CD6C0">
		<meta name="msapplication-TileColor" content="#4CD6C0">

		<!-- Preconnect to critical third-party origins (highest priority) -->
		<link rel="preconnect" href="https://www.googletagmanager.com">

		<!-- Preload critical font files for better performance -->
		<!-- Only preload fonts that are used above the fold -->
		<link rel="preload" href="/fonts/Inter-Regular.woff2" as="font" type="font/woff2" crossorigin>
		<link rel="preload" href="/fonts/Inter-Bold.woff2" as="font" type="font/woff2" crossorigin>

		<!-- Preload critical above-the-fold resources -->
		<link rel="preload" href="/images/logo-kreadium.webp" as="image" type="image/webp" fetchpriority="high">

		<!-- DNS prefetch for other domains (lower priority) -->
		<link rel="dns-prefetch" href="https://vercel.live">

		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="geo.region" content="CL-RM">
        <meta name="geo.placename" content="Santiago, Chile">
		<!-- Open Graph Meta Tags -->
		<meta property="og:title" content={ogTitle}>
		<meta property="og:description" content={ogDescription}>
		<meta property="og:image" content={ogImage}>
		<meta property="og:url" content={`https://kreadium.cl${canonical}`}>
		<meta property="og:type" content="website">
		<meta property="og:site_name" content="Kreadium">
		<meta property="og:locale" content="es_CL">
		<!-- Twitter Card Meta Tags -->
		<meta name="twitter:card" content="summary_large_image">
		<meta name="twitter:title" content={ogTitle}>
		<meta name="twitter:description" content={ogDescription}>
		<meta name="twitter:image" content={ogImage}>
		<meta name="twitter:site" content="@kreadium">
		<meta name="twitter:creator" content="@kreadium">

		<!-- Meta Tags adicionales recomendados -->
		<meta name="description" content={description}>
		<meta name="author" content="Kreadium SpA">
		<meta name="robots" content={noindex ? "noindex, follow" : "index, follow"}>

		<!-- Favicon -->
		<link rel="icon" type="image/x-icon" href="/favicon.ico">
		<link rel="apple-touch-icon" href="/apple-touch-icon.png">

		<!-- Canonical URL -->
		<link rel="canonical" href={`https://kreadium.cl${canonical}`}>

		<!-- Search Console -->
		<meta name="google-site-verification" content="nym61f8HzIaAPGnOQEDUEEaCC3UwC-jJ0cUkCCpG_UM" />

		<!-- Robots -->
        <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">

		<title>{title}</title>

		<!-- Critical CSS inline for immediate rendering (eliminates render-blocking) -->
		<style>
			/* Minimal critical CSS for immediate paint */
			html{font-family:system-ui,-apple-system,sans-serif;-webkit-text-size-adjust:100%}
			body{margin:0;background:#000;color:#fff;overflow-x:hidden}
			/* Prevent layout shift for header */
			header{height:70px}
			@media(min-width:768px){header{height:80px}}
			/* Above-the-fold Hero optimization */
			#home{min-height:100vh;display:flex;align-items:center;justify-content:center}
		</style>

		<!-- Deferred Analytics - Load after page is interactive -->
		<script is:inline>
			// Defer GTM and Analytics to not block rendering
			function loadAnalytics() {
				// Google Tag Manager
				(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
				new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
				j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
				'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
				})(window,document,'script','dataLayer','GTM-5WJQJBJW');
			}

			// Load analytics after page is interactive
			if ('requestIdleCallback' in window) {
				requestIdleCallback(loadAnalytics, { timeout: 2000 });
			} else {
				// Fallback for browsers without requestIdleCallback
				if (document.readyState === 'complete') {
					loadAnalytics();
				} else {
					window.addEventListener('load', loadAnalytics);
				}
			}
		</script>
		<!-- End Deferred Analytics -->

		<!-- Structured Data - Organization Schema -->
		<script is:inline type="application/ld+json">
		{
			"@context": "https://schema.org",
			"@type": "Organization",
			"name": "Kreadium SpA",
			"url": "https://kreadium.cl",
			"logo": "https://kreadium.cl/images/logo-kreadium.webp",
			"description": "Agencia de desarrollo web en Chile especializada en WordPress, Shopify y ecommerce",
			"address": {
				"@type": "PostalAddress",
				"streetAddress": "Antonio Bellet 193 OF 1210",
				"addressLocality": "Providencia",
				"addressRegion": "Santiago",
				"addressCountry": "CL"
			},
			"contactPoint": {
				"@type": "ContactPoint",
				"email": "contacto@kreadium.cl",
				"contactType": "customer service",
				"availableLanguage": "Spanish"
			},
			"sameAs": [
				"https://www.linkedin.com/company/kreadium-spa/",
				"https://www.instagram.com/agencia_kreadium/"
			],
			"areaServed": {
				"@type": "Country",
				"name": "Chile"
			}
		}
		</script>

		<!-- Structured Data - LocalBusiness Schema -->
		<script is:inline type="application/ld+json">
		{
			"@context": "https://schema.org",
			"@type": "LocalBusiness",
			"@id": "https://kreadium.cl",
			"name": "Kreadium SpA",
			"image": "https://kreadium.cl/images/logo-kreadium.webp",
			"email": "contacto@kreadium.cl",
			"address": {
				"@type": "PostalAddress",
				"streetAddress": "Antonio Bellet 193 OF 1210",
				"addressLocality": "Providencia",
				"addressRegion": "RM",
				"addressCountry": "CL"
			},
			"geo": {
				"@type": "GeoCoordinates",
				"latitude": -33.4372,
				"longitude": -70.6506
			},
			"openingHours": "Mo-Fr 09:00-18:00",
			"priceRange": "$$"
		}
		</script>

		<!-- Structured Data - WebSite Schema with SearchAction -->
		<script is:inline type="application/ld+json">
		{
			"@context": "https://schema.org",
			"@type": "WebSite",
			"name": "Kreadium",
			"url": "https://kreadium.cl",
			"potentialAction": {
				"@type": "SearchAction",
				"target": "https://kreadium.cl/buscar?q={search_term_string}",
				"query-input": "required name=search_term_string"
			}
		}
		</script>
		</head>
	<body>
		<WhatsappButton />
		<Header />
		<slot />
		<Footer />

		<!-- Google Tag Manager (noscript) -->
			<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5WJQJBJW"
			height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
		<!-- End Google Tag Manager (noscript) -->
	</body>
</html>
<style is:global>
	/* Custom Font Declarations - Inter Font Family */
	/* Using WOFF2 for maximum compression and performance */

	/* Inter Regular - 400 */
	@font-face {
		font-family: 'Inter';
		src: url('/fonts/Inter-Regular.woff2') format('woff2');
		font-weight: 400;
		font-style: normal;
		font-display: swap; /* Show fallback font immediately, swap when loaded */
		unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
	}

	/* Inter Medium - 500 */
	@font-face {
		font-family: 'Inter';
		src: url('/fonts/Inter-Medium.woff2') format('woff2');
		font-weight: 500;
		font-style: normal;
		font-display: swap;
		unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
	}

	/* Inter SemiBold - 600 */
	@font-face {
		font-family: 'Inter';
		src: url('/fonts/Inter-SemiBold.woff2') format('woff2');
		font-weight: 600;
		font-style: normal;
		font-display: swap;
		unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
	}

	/* Inter Bold - 700 */
	@font-face {
		font-family: 'Inter';
		src: url('/fonts/Inter-Bold.woff2') format('woff2');
		font-weight: 700;
		font-style: normal;
		font-display: swap;
		unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
	}

	/* Inter ExtraBold - 800 */
	@font-face {
		font-family: 'Inter';
		src: url('/fonts/Inter-ExtraBold.woff2') format('woff2');
		font-weight: 800;
		font-style: normal;
		font-display: swap;
		unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
	}

	:root {
		--accent: #4CD6C0;
		--accent-hover: #09b397;
		--bg-dark: #000000;
		--text-light: #ffffff;

		/* Custom font stack - Inter with system font fallbacks */
		--font-sans: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";

		/* Font weight custom properties for consistency */
		--font-weight-normal: 400;
		--font-weight-medium: 500;
		--font-weight-semibold: 600;
		--font-weight-bold: 700;
		--font-weight-extrabold: 800;
	}

	/* Base styles - low specificity to allow Tailwind to override */
	html {
		font-family: var(--font-sans);
		background: var(--bg-dark);
		color: var(--text-light);
		scroll-behavior: smooth;
		overflow-x: hidden;

		/* Prevent font size adjustments on orientation change */
		-webkit-text-size-adjust: 100%;
		text-size-adjust: 100%;

		/* Font rendering optimizations */
		-webkit-font-smoothing: antialiased;
		-moz-osx-font-smoothing: grayscale;
		text-rendering: optimizeLegibility;
	}

	body {
		margin: 0;
		padding: 0;
		overflow-x: hidden;
		font-family: var(--font-sans);

		/* Font rendering consistency */
		-webkit-font-smoothing: antialiased;
		-moz-osx-font-smoothing: grayscale;
		text-rendering: optimizeLegibility;
	}

	/* Inherit font family for all elements */
	*,
	*::before,
	*::after {
		font-family: inherit;
	}

	/* Prevent font boosting on Android Chrome */
	body, html, h1, h2, h3, h4, h5, h6, p, span, div, a, button, input, textarea, select {
		max-height: 999999px;
	}

	/* Ensure headings inherit font settings */
	h1, h2, h3, h4, h5, h6 {
		font-family: inherit;
		font-weight: inherit;
	}

	/* Ensure form elements use consistent fonts */
	input, textarea, select, button {
		font-family: inherit;
	}

	/* iOS Safari specific fixes - Enable font synthesis */
	@supports (-webkit-touch-callout: none) {
		/* Enable font synthesis for bold/italic on iOS */
		html,
		body,
		* {
			-webkit-font-synthesis: weight style;
			font-synthesis: weight style;
		}
	}
</style>